<div class="container">
  <% if @cart.line_items.count > 0 %>
    <h1 class="mt-5">MI CARRITO</h1>
    <div id="cart">
      <div class="cart-products">
        <% total_quantity = 0 %>
        <% @cart.line_items.reverse.each do |line_item| %>
          <div class="cart-product d-flex align-items-center bg-white">
            <%= cl_image_tag line_item.photo_key, height: 150, width: 150, crop: :fill %>
            <div>
              <p>
                <b>
                  <%= link_to line_item.product_variation.product.name, product_path(line_item.product_variation.product.id) %>
                </b>
              </p>
              <% if line_item.product_variation.color != '' %>
                <p>Color: <%= line_item.product_variation.color %></p>
              <% end %>
              <p>Tama√±o: <%= line_item.product_variation.size %></p>
              <p>
                <% if line_item.product_variation.discount_price %>
                  <span class="crossed">$<%= line_item.product_variation.price %></span>
                  <span>$<%= line_item.product_variation.discount_price %></span>
                <% else %>
                  $<%= line_item.product_variation.price %>
                <% end %>
              </p>
              <div class="quantity-counter d-flex">
                <%= link_to "-", reduce_quantity_line_item_path(line_item), method: :post, remote: true %>
                <span class="grow-1 text-center"><%= line_item.quantity %></span>
                <%= link_to "+", add_quantity_line_item_path(line_item), method: :post, remote: true %>
              </div>
              <span class="remove-items">
                <%= link_to line_item_path(line_item), method: :delete do %>
                  <i class="far fa-trash-alt"></i>
                <% end %>
              </span>
              <% total_quantity += line_item.quantity %>
            </div>
          </div>
        <% end %>
      </div>
      <div class="cart-detail padding-30">
        <h2>RESUMEN DE COMPRA</h2>
        <hr>
        <p><%= pluralize(total_quantity, 'producto') %></p>
        <p>Sub Total: $<%= @cart.sub_total %></p>
        <p>Entrega: $<%= @cart.shipping %></p>
        <p>ITBMS (7%): $<%= (@cart.itbms) %></p>
        <p><b>TOTAL: $<%= @cart.total %></b></p>
        <% if user_signed_in? %>
          <p><%= link_to "Ordenar", new_user_order_path(current_user), class: 'btn btn-blue w-100' %></p>
        <% else %>
          <p><%= link_to "Ordenar", new_fake_user_path, class: 'btn btn-blue w-100' %></p>
        <% end %>
        <div class="cart-footer-bottom">
          <p class='text-center'>Todos los pagos se hacen contra entrega. Gracias por preferirnos.</p>
          <div class="payment-logos">
          <%= cl_image_tag 'https://res.cloudinary.com/blueforest/image/upload/v1591088125/payments-logo/1-visa_unvmtw.png', width: 50, crop: :fill %>
          <%= cl_image_tag 'https://res.cloudinary.com/blueforest/image/upload/v1591088122/payments-logo/2-mastercard_scrnh5.png', width: 50, crop: :fill %>
          <%= cl_image_tag 'https://res.cloudinary.com/blueforest/image/upload/v1591088123/payments-logo/3-clave_dzrpsj.png', width: 50, crop: :fill %>
          <%= cl_image_tag 'https://res.cloudinary.com/blueforest/image/upload/v1591088122/payments-logo/4-yappy_mzep5g.png', width: 50, crop: :fill %>
          <%= cl_image_tag 'https://res.cloudinary.com/blueforest/image/upload/v1591088122/payments-logo/5-ach_ddyell.png', width: 50, crop: :fill %>
          <%= cl_image_tag 'https://res.cloudinary.com/blueforest/image/upload/v1591088122/payments-logo/6-cash_fa0zx5.png', width: 50, crop: :fill %>
          </div>
        </div>
      </div>
    </div>
  <% else %>
  <div class="text-center my-5">
    <h2>Carrito vacillo</h2>
    <br>
    <%= link_to 'Ver productos', root_path(anchor: 'products'), class: 'btn btn-blue' %>
  </div>
  <% end %>
</div>

